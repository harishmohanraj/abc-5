name: Pipeline
on: [push, workflow_dispatch]

jobs:
    unit_test:
      name: Run tests and verify build
      runs-on: ubuntu-latest
      permissions:
          contents: read
          packages: write
      steps:
          - name: Checkout repository
            uses: actions/checkout@v4

          - uses: 8BitJonny/gh-get-current-pr@3.0.0
            id: PR
          - run: |
              echo "Your PR number is ${{ steps.PR.outputs.number }} and its JSON is ${{ steps.PR.outputs.pr }}"
              echo "Your PR title is ${{ steps.PR.outputs.pr_title }}"

              if [[ "${{ steps.PR.outputs.pr_title }}" == "Add Fly.io configuration files" ]]; then
                echo "is_pr_for_setup=true" >> $GITHUB_OUTPUT
              else
                echo "is_pr_for_setup=false" >> $GITHUB_OUTPUT
              fi
              echo "The value of is_pr_for_setup is:"
              cat $GITHUB_OUTPUT
            shell: bash

